(()=>{"use strict";var t={780:t=>{t.exports=require("iframe-resizer")},252:t=>{t.exports=require("iframe-resizer/js/iframeResizer.contentWindow")}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{ExtensionCommandType:()=>f,ExtensionEventType:()=>_,initializeExtensionService:()=>y});const t=require("tslib"),e=function(e){function n(t){var n=e.call(this,t||"Invalid arguments have been provided.")||this;return n.name="InvalidArgumentError",n.type="invalid_argument",n}return(0,t.__extends)(n,e),n}(function(e){function n(t){var n,r,o=this.constructor,i=e.call(this,t||"An unexpected error has occurred.")||this;return i.name="StandardError",i.type="standard",n=i,r=o.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(i,o):i.stack=new Error(i.message).stack,i}return(0,t.__extends)(n,e),n}(Error));function o(t){if(!/^(https?:)?\/\//.test(t))throw new e("The provided URL must be absolute.");var n=document.createElement("a");n.href=t;var r=n.port&&-1!==t.indexOf(n.hostname+":"+n.port)?n.port:"";return{hash:n.hash,hostname:n.hostname,href:n.href,origin:n.protocol+"//"+n.hostname+(r?":"+r:""),pathname:n.pathname,port:r,protocol:n.protocol,search:n.search}}const i=function(e,n,r){return n&&r?s(0,n,r):function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,t.__extends)(n,e),n}(e);return Object.getOwnPropertyNames(e.prototype).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e.prototype,t);r&&"constructor"!==t&&Object.defineProperty(n.prototype,t,s(e.prototype,t,r))})),n}(e)};function s(e,n,r){if("function"!=typeof r.value)return r;var o=r.value;return{get:function(){var e=o.bind(this);return Object.defineProperty(this,n,(0,t.__assign)((0,t.__assign)({},r),{value:e})),e},set:function(t){o=t}}}function a(t,e){return t.type===e}const p=function(){function e(t){var e;this._sourceOrigins=[o(t).origin,(e=o(t),o(0===e.hostname.indexOf("www")?e.href:e.href.replace(e.hostname,"www."+e.hostname))).origin],this._isListening=!1,this._listeners={}}return e.prototype.listen=function(){this._isListening||(this._isListening=!0,window.addEventListener("message",this._handleMessage))},e.prototype.stopListen=function(){this._isListening&&(this._isListening=!1,window.removeEventListener("message",this._handleMessage))},e.prototype.addListener=function(t,e){var n=this._listeners[t];n||(this._listeners[t]=n=[]),-1===n.indexOf(e)&&n.push(e)},e.prototype.removeListener=function(t,e){var n=this._listeners[t];if(n){var r=n.indexOf(e);r>=0&&n.splice(r,1)}},e.prototype.trigger=function(t,e){var n=this._listeners[t.type];n&&n.forEach((function(n){return e?n(t,e):n(t)}))},e.prototype._handleMessage=function(e){if(-1!==this._sourceOrigins.indexOf(e.origin)&&a(e.data,e.data.type)){var n=e.data,r=n.context,o=(0,t.__rest)(n,["context"]);this.trigger(o,r)}},(0,t.__decorate)([i],e.prototype,"_handleMessage",null),e}(),c=require("rxjs"),u=require("rxjs/operators"),d=function(){function e(t,e,n){this._targetWindow=e,this._context=n,this._targetOrigin="*"===t?"*":o(t).origin}return e.prototype.post=function(e,n){var r=this,o=this._targetWindow;if(window!==o){if(!o)throw new Error("Unable to post message because target window is not set.");var i=n&&(0,c.fromEvent)(window,"message").pipe((0,u.filter)((function(t){return t.origin===r._targetOrigin&&a(t.data,t.data.type)&&-1!==[n.successType,n.errorType].indexOf(t.data.type)})),(0,u.map)((function(t){if(n.errorType===t.data.type)throw t.data;return t.data})),(0,u.take)(1)).toPromise();return o.postMessage((0,t.__assign)((0,t.__assign)({},e),{context:this._context}),this._targetOrigin),i}},e.prototype.setTarget=function(t){this._targetWindow=t},e.prototype.setContext=function(t){this._context=t},e}(),h=require("lodash");var f,_,l;!function(t){t.ReloadCheckout="EXTENSION:RELOAD_CHECKOUT",t.ShowLoadingIndicator="EXTENSION:SHOW_LOADING_INDICATOR",t.SetIframeStyle="EXTENSION:SET_IFRAME_STYLE"}(f||(f={})),function(t){t.ConsignmentsChanged="EXTENSION:CONSIGNMENTS_CHANGED"}(_||(_={})),function(t){t.Subscribe="EXTENSION_INTERNAL:SUBSCRIBE",t.Unsubscribe="EXTENSION_INTERNAL:UNSUBSCRIBE",t.ResizeIframe="EXTENSION_INTERNAL:RESIZE_IFRAME"}(l||(l={}));const m=function(){function t(t,e,n){this._eventListener=t,this._commandPoster=e,this._internalCommandPoster=n,this._commandPoster.setTarget(window.parent),this._internalCommandPoster.setTarget(window.parent)}return t.prototype.initialize=function(t){if(!t)throw new Error("Extension Id not found.");this._extensionId=t,this._eventListener.listen(),this._commandPoster.setContext({extensionId:t}),this._internalCommandPoster.post({type:l.ResizeIframe,payload:{extensionId:t}})},t.prototype.post=function(t){if(!Object.values(f).includes(t.type))throw new Error(t.type+" is not supported.");this._commandPoster.post(t)},t.prototype.addListener=function(t,e){var n=this;if(void 0===e&&(e=h.noop),!this._extensionId)throw new Error("Extension is not initialized.");var r=this._extensionId;if(!Object.values(_).includes(t))throw new Error(t+" is not supported.");return this._internalCommandPoster.post({type:l.Subscribe,payload:{extensionId:r,eventType:t}}),this._eventListener.addListener(t,e),function(){n._internalCommandPoster.post({type:l.Unsubscribe,payload:{extensionId:r,eventType:t}}),n._eventListener.removeListener(t,e)}},t}();function y(t){var e=t.extensionId,r=t.parentOrigin;n(252);var o=new m(new p(r),new d(r),new d(r));return o.initialize(e),o}})(),module.exports=r})();
//# sourceMappingURL=extension.js.map